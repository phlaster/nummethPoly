\documentclass[a4paper, 14pt]{article}
\usepackage[russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{setspace}
\setstretch{1.3}
\usepackage{anyfontsize}
\usepackage{amsmath, amsfonts, amssymb, amsthm, mathtools}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{wrapfig}
\geometry{a4paper, portrait, margin=10mm, bmargin=15mm, tmargin=15mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\include{titlepage}

\pagenumbering{arabic}

\setcounter{page}{2}


\section*{Исходные данные}

На двух интервалах заданы функции:

\begin{align}
    \label{f1}
    f_1(x) &= \ctg(x) + x^2, &\hspace{-2cm}  x &\in [0.5, 2.75]; \\
    \label{f2}
    f_2(x) &= x^5 - 3.2x^3 + 2.5x^2 - 7x + 1.5, &\hspace{-2cm} x &\in [-2.4, 2.1];
\end{align}

\begin{figure}[h] \centering
    \caption{Графики функций}
    \includegraphics[width=0.7\linewidth]{pics/f1_f2}
    \label{pic:f1_f2}
\end{figure}

\clearpage

\section{Аппроксимация функции многочленом Лагранжа}

\subsection{Формулы}

По формуле многочлена Лагранжа $(n=i_{\max} = 3)$:

\begin{equation}
    L(x)=\sum_{i=0}^{n}y_il_i(x),
\end{equation}

где базисные полиномы определяются по формуле:

\begin{equation}
    \label{l_i}
    l_i(x)=\prod_{j=0,j\ne i}^{n}\cfrac{x-x_j}{x_i-x_j}
\end{equation}

\subsection{Условия применимости}

\begin{itemize}
    \item Для интерполяции $f(x)$ на отрезке полиномом степени n, необходимо иметь хотя бы n+1 узел;
    \item Альтернативно: интерполируемая на $[a,b]$ функция должна быть на нём дифференциируема хотя бы $n+1$ раз, т.е.: $f(x)\in C^{n+1}_{[a,b]}$
    \item $f(x)$ не должна содержать заданном отрезке особых точек: асимптот, неустранимых разрывов и т.д.: многочлен Лагранжа -- полином, таких точек у него быть не может;
    \item Абсциссы точек не должны повторяться, говоря иначе, определитель матрицы Вандермонда не должен быть равен нулю:
    \begin{equation}
        \det(V) =
        \begin{vmatrix}
            1 & x_0 & x_0^2 & \hdots & x_0^n \\
            1 & x_1 & x_1^2 & \hdots & x_1^n \\
            \vdots & \vdots & \vdots & \vdots & \vdots \\
            \vdots & \vdots & \vdots & \ddots & \vdots \\
            1 & x_n & x_n^2 & \hdots & x_n^n
        \end{vmatrix} =
        \prod_{i>j}{(x_i-x_j)} \ne 0
    \end{equation}
    В противном случае в (\ref{l_i}) возникнет множитель с нулём в знаменателе.
\end{itemize}

{\bf На заданных отрезках (\ref{f1}) и (\ref{f2}) удовлетворяют всем условиям выше.}

\subsection{Численный расчёт}

Рассмотрим алгоритм приближения функций по её известным табличным значениям на примере (\ref{f1}). Вычислим точно её значения в нескольких точках:

\begin{align}
    \label{4nodes_f1}
    \begin{tabular}{|c|c|c|}
        \hline
        $i$ & $x_i$ & $y_i$ \\
        \hline
        0 & 0.5 & 2.08049 \\
        \hline
        1 & 1.25 & 1.89477 \\
        \hline
        2 & 2 & 3.54234 \\
        \hline
        3 & 2.75 & 5.14071 \\
        \hline
    \end{tabular}
\end{align}

Получим глобальный полином Лагранжа:
\nopagebreak
\begin{equation}
    \begin{split}
    L(x) = & 2.08049\cdot\frac{x-1.25}{0.5-1.25}\cdot\frac{x-2}{0.5-2}\cdot\frac{x-2.75}{0.5-2.75} +\\
    &+ 1.89477\cdot\frac{x-0.5}{1.25-0.5}\cdot\frac{x-2}{1.25-2}\cdot\frac{x-2.75}{1.25-2.75} +\\
    &+ 3.54234\cdot\frac{x-0.5}{2-0.5}\cdot\frac{x-1.25}{2-1.25}\cdot\frac{x-2.75}{2-2.75} +\\
    &+ 5.14071\cdot\frac{x-0.5}{2.75-0.5}\cdot\frac{x-1.25}{2.75-1.25}\cdot\frac{x-2}{2.75-2} =\\
    = & -0.821922 x^3 + 4.93153 x^2 - 9.40073 x + 5.65071 +\\
    &+ 2.24565 x^3 - 11.7897 x^2 + 17.6845 x - 6.17555 -\\
    &- 4.19833 x^3 + 18.8925 x^2 - 22.8284 x + 7.21588 +\\
    &+ 2.0309 x^3 - 7.61587 x^2 + 8.37745 x - 2.53862 = \\
    = & \bf 0.07822 x^3 + 4.41846 x^2 - 6.16718 x + 4.15242
    \end{split}
\end{equation}

Получено кубическое уравнение. Табулируя его по $4\cdot100$ точкам, получим следующую таблицу значений:

\begin{align}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $k$ & $x_k$ & $f_1(x_k)$ & $L(x_k)$ & $|L(x_k)-f_1(x_k)|$ \\
        \hline
        1 & 0.5      & 2.08049 & 2.08049 & 0 \\
        \hline
        2 & 0.505639 & 2.061887& 2.06759 &  0.00571114 \\
        \hline
        3 & 0.511278 & 2.04382 & 2.05489 &  0.0110783 \\
        \hline
        ... & ... & ... & ... &  ... \\
        \hline
        399 & 2.74436   & 5.14792 & 5.13354 & 0.0143777 \\
        \hline
        400 & 2.75 & 5.14071  & 5.14071 &  0 \\
        \hline
    \end{tabular}\\
    |L(x_k)-f_1(x_k)| \le 0.188516
\end{align}

\clearpage

\subsection{Графики}

\subsubsection{$f_1(x):$}

\input{pics2-5}

\clearpage

\subsubsection{$f_2(x):$}

\input{pics6-9}

\clearpage

\section{Аппроксимация функции сплайном Эрмита}

\subsection{Формулы}

Показано\footnote{Вержбицкий, стр.459}, что имея на некотором отрезке $[a,~b]$ в попарно различных узлах $\{x_0,...,x_n\}$ соответствующие значения функции $\{y_0,...,y_n\}$ и соответствующие значения производных до (включая) порядка $m$: $\{y^{(m)}_0,...,y^{(m)}_n\}$ можно построить единственный интерполяционный многочлен Эрмита степени $(n+1)(m+1)-1$. Составляя набор таких многочленов между парами последовательных точек $\{x_i,~x_{i+1}\}$ получим \textbf{сплайн Эрмита} степени $2m+1$:

\begin{equation}
    S_{2m+1}(x):=\left\lbrace H^i_{2m+1} (x), ~ x \in [x_{i-1},~ x_i] \right\rbrace^n_{i=1}
\end{equation}

\subsection{Условия применимости}

Как следует из написанного выше, для получения сплайна степени $2m+1$, требуется иметь в узлах значения производных функции как минимум $m$-го порядка и непрерывность на интервале интерполяции производных хотя бы до $(m+1)$-го порядка.

\subsection{Численный расчёт}

Заданные функции $f_1$ и $f_2$ заведомо удовлетворяют условиям. Для построения кубического сплайна Эрмита нужны значения первой производной во всех узлах. Используем прежнюю таблицу узлов $(\ref{4nodes_f1})$ функции $f_1(x)$. Производные внутренних узлов приблизим методом секущих:
\begin{align}
    \mathtt{f'}(x_i) &= \frac{f(x_{i+1})-f(x_{i-1})}{x_{i+1}-x_{i-1}} \\
    \mathtt{f_1'}(x_1) &= \frac{f(x_2)-f(x_0)}{x_2-x_0}=\frac{3.54234-2.08049}{2-0.5}=0.9745667 \\
    \mathtt{f_1'}(x_2) &= \frac{f(x_3)-f(x_1)}{x_3-x_1}=\frac{5.14071-1.89477}{2.75-1.25}=2.16396
\end{align}

Для приближения производной каждой крайней точки используем трёхточечный многочлен Лагранжа по крайним точкам:
\begin{tabbing}
    \hspace*{5cm}\= \hspace*{1.7cm} \= \hspace*{3cm} \= \kill
    \>
    $\begin{smallmatrix}
        \text{Узлы для}\\
        L_{left}\\
    \end{smallmatrix}
    \begin{cases}
        \\\\
    \end{cases}$
    \>
    \begin{tabular}{|c|c|c|}
        \hline
        $i$ & $x_i$ & $y_i$ \\
        \hline
        0 & 0.5 & 2.08049 \\
        \hline
        1 & 1.25 & 1.89477 \\
        \hline
        2 & 2 & 3.54234 \\
        \hline
        3 & 2.75 & 5.14071 \\
        \hline
    \end{tabular}
    \>\raisebox{-0.6\height}{
        $\begin{rcases}
            \\\\\\
        \end{rcases}
        \begin{smallmatrix}
                \text{Узлы для}\\
                L_{right}
        \end{smallmatrix}$\\
    }
\end{tabbing}

Получившиеся <<левый>> и <<правый>> полиномы:
\begin{align}
    L_{left}(x)  &= 1.62959x^2 - 3.09941x + 3.222798\\
    L_{right}(x) &=-0.04373x^2 + 2.33889x - 0.960513
\end{align}

Тогда производные в крайних точках выражаются аналитически:
\begin{align}
    \mathtt{f_1'}(x_0) &= \dfrac{d}{dx} ~ L_{left}(x_0) = 3.25918x_0 - 3.09941 = -1.46982\\
    \mathtt{f_1'}(x_3) &= \dfrac{d}{dx} ~ L_{right}(x_3)= -0.08746x_3 + 2.33889 = 2.098375
\end{align}

Построим таблицу с полученными приближениями первой производной на узлах:
\begin{align}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $i$ & $x_i$ & $f_1'(x_i)$ & $\mathtt{f_1'}(x_i)$ & $|\mathtt{f_1'}(x_i)-f_1'(x_i)|$ \\
        \hline
        0 & 0.5 & -3.35069 & -1.46982 & 1.88088\\
        \hline
        1 &  1.25 & 1.38959 & 0.97457 &0.415020\\
        \hline
        2 &  2 &  2.79055 & 2.16396 &0.626590\\
        \hline
        3 &  2.75 & -1.36506 & 2.09836 &3.46342\\
        \hline
    \end{tabular}\\
    0.42 \le \varepsilon \le 3.46
\end{align}

Ищем $i$-е звено сплайна $S_3(x)$ в виде:

\begin{equation}
    content
\end{equation}
































\end{document}