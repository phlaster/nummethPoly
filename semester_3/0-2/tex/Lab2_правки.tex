\input{settings}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\include{titlepage}

\pagenumbering{arabic}

\setcounter{page}{2}
\tableofcontents
\clearpage
\section*{Исходные данные}

На двух интервалах заданы функции:
\begin{align}
    \label{f1}
    f_1(x) &= \ctg(x) + x^2, &\hspace{-2cm}  x &\in [0.5, 2.75]; \\
    \label{f2}
    f_2(x) &= x^5 - 3.2x^3 + 2.5x^2 - 7x + 1.5, &\hspace{-2cm} x &\in [-2.4, 2.1];
\end{align}

\begin{figure}[h] \centering
    \caption{Графики функций}
    \includegraphics[width=0.7\linewidth]{pics/f1_f2}
    \label{pic:f1_f2}
\end{figure}

\clearpage

\section{Аппроксимация функции многочленом Лагранжа}

\subsection{Формулы}

По формуле многочлена Лагранжа $(n=i_{\max} = 3)$:
\begin{equation}
    L(x)=\sum_{i=0}^{n}y_il_i(x),
\end{equation}

где базисные полиномы определяются по формуле:
\begin{equation}
    \label{l_i}
    l_i(x)=\prod_{j=0,j\ne i}^{n}\cfrac{x-x_j}{x_i-x_j}
\end{equation}

\subsection{Условия применимости}

\begin{itemize}
    \item Для интерполяции $f(x)$ на отрезке полиномом степени n, необходимо иметь хотя бы n+1 узел;
    \item Альтернативно: интерполируемая на $[a,b]$ функция должна быть на нём дифференциируема хотя бы $n+1$ раз, т.е.: $f(x)\in C^{n+1}_{[a,b]}$
    \item $f(x)$ не должна содержать заданном отрезке особых точек: асимптот, неустранимых разрывов и т.д.: многочлен Лагранжа -- полином, таких точек у него быть не может;
    \item Абсциссы точек не должны повторяться, говоря иначе, определитель матрицы Вандермонда не должен быть равен нулю:
    \begin{equation}
        \det(V) =
        \begin{vmatrix}
            1 & x_0 & x_0^2 & \hdots & x_0^n \\
            1 & x_1 & x_1^2 & \hdots & x_1^n \\
            \vdots & \vdots & \vdots & \vdots & \vdots \\
            \vdots & \vdots & \vdots & \ddots & \vdots \\
            1 & x_n & x_n^2 & \hdots & x_n^n
        \end{vmatrix} =
        \prod_{i>j}{(x_i-x_j)} \ne 0
    \end{equation}
    В противном случае в (\ref{l_i}) возникнет множитель с нулём в знаменателе.
\end{itemize}
{\bf На заданных отрезках (\ref{f1}) и (\ref{f2}) удовлетворяют всем условиям выше.}

\subsection{Численный расчёт}
Рассмотрим алгоритм приближения функций по её известным табличным значениям на примере (\ref{f1}). Вычислим точно её значения в нескольких точках:
\begin{align}
    \label{4nodes_f1}
    \begin{tabular}{|c|c|c|}
        \hline
        $i$ & $x_i$ & $y_i$ \\
        \hline
        0 & 0.5 & 2.08049 \\
        \hline
        1 & 1.25 & 1.89477 \\
        \hline
        2 & 2 & 3.54234 \\
        \hline
        3 & 2.75 & 5.14071 \\
        \hline
    \end{tabular}
\end{align}

Получим глобальный полином Лагранжа:
\nopagebreak
\begin{equation}
    \begin{split}
    L(x) = & 2.08049\cdot\frac{x-1.25}{0.5-1.25}\cdot\frac{x-2}{0.5-2}\cdot\frac{x-2.75}{0.5-2.75} +\\
    &+ 1.89477\cdot\frac{x-0.5}{1.25-0.5}\cdot\frac{x-2}{1.25-2}\cdot\frac{x-2.75}{1.25-2.75} +\\
    &+ 3.54234\cdot\frac{x-0.5}{2-0.5}\cdot\frac{x-1.25}{2-1.25}\cdot\frac{x-2.75}{2-2.75} +\\
    &+ 5.14071\cdot\frac{x-0.5}{2.75-0.5}\cdot\frac{x-1.25}{2.75-1.25}\cdot\frac{x-2}{2.75-2} =\\
    = & -0.821922 x^3 + 4.93153 x^2 - 9.40073 x + 5.65071 +\\
    &+ 2.24565 x^3 - 11.7897 x^2 + 17.6845 x - 6.17555 -\\
    &- 4.19833 x^3 + 18.8925 x^2 - 22.8284 x + 7.21588 +\\
    &+ 2.0309 x^3 - 7.61587 x^2 + 8.37745 x - 2.53862 = \\
    = & \bf 0.07822 x^3 + 4.41846 x^2 - 6.16718 x + 4.15242
    \end{split}
\end{equation}

Получено кубическое уравнение. Табулируя его по $4\cdot100$ точкам, получим следующую таблицу значений:
\begin{align}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $k$ & $x_k$ & $f_1(x_k)$ & $L(x_k)$ & $|L(x_k)-f_1(x_k)|$ \\
        \hline
        1 & 0.5      & 2.08049 & 2.08049 & 0 \\
        \hline
        2 & 0.505639 & 2.061887& 2.06759 &  0.00571114 \\
        \hline
        3 & 0.511278 & 2.04382 & 2.05489 &  0.0110783 \\
        \hline
        $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ &  $\vdots$ \\
        \hline
        399 & 2.74436   & 5.14792 & 5.13354 & 0.0143777 \\
        \hline
        400 & 2.75 & 5.14071  & 5.14071 &  0 \\
        \hline
    \end{tabular}\\
    |L(x_k)-f_1(x_k)| \le 0.188516
\end{align}

\clearpage

\subsection{Графики}

\subsubsection{Трансцендентная $f_1(x):$}
\input{pics2-5}

\clearpage

\subsubsection{Полином 5-й степени $f_2(x):$}
\input{pics6-9}

\subsubsection*{Комментарий}
Из графика следует, что несмотря на рост максимальной ошибки на интервале из-за феномена Рунге, существуют точки, в которых ошибка не растёт.

\clearpage

\section{Аппроксимация функции сплайном Эрмита}

\subsection{Формулы}

Показано\footnote{Вержбицкий, стр.459}, что имея на некотором отрезке $[a,~b]$ в попарно различных узлах $\{x_0,...,x_n\}$ соответствующие значения функции $\{y_0,...,y_n\}$ и соответствующие значения производных до (включая) порядка $m$: $\{y^{(m)}_0,...,y^{(m)}_n\}$ можно построить единственный интерполяционный многочлен Эрмита степени $(n+1)(m+1)-1$. Составляя набор таких многочленов между парами последовательных точек $\{x_i,~x_{i+1}\}$ получим \textbf{сплайн Эрмита} степени $2m+1$ (нечётной степени):

\begin{equation}
    S_{2m+1}(x):=\left\lbrace H^i_{2m+1} (x), ~ x \in [x_{i-1},~ x_i] \right\rbrace^n_{i=1}
\end{equation}

\subsection{Условия применимости}

Как следует из написанного выше, для получения сплайна степени $2m+1$, требуется иметь в узлах значения производных функции как минимум $m$-го порядка и непрерывность на интервале интерполяции производных хотя бы до $(m+1)$-го порядка.

\subsection{Численный расчёт}

Заданные функции $f_1$ и $f_2$ заведомо удовлетворяют условиям. Для построения кубического сплайна Эрмита нужны значения первой производной во всех узлах. Используем прежнюю таблицу узлов $(\ref{4nodes_f1})$ функции $f_1(x)$. Производные внутренних узлов приблизим методом секущих:
\begin{align}
    \mathtt{f'}(x_i) &= \frac{f(x_{i+1})-f(x_{i-1})}{x_{i+1}-x_{i-1}} \\
    \mathtt{f_1'}(x_1) &= \frac{f(x_2)-f(x_0)}{x_2-x_0}=\frac{3.54234-2.08049}{2-0.5}=0.9745667 \\
    \mathtt{f_1'}(x_2) &= \frac{f(x_3)-f(x_1)}{x_3-x_1}=\frac{5.14071-1.89477}{2.75-1.25}=2.16396
\end{align}

Для приближения производной каждой крайней точки используем трёхточечный многочлен Лагранжа по крайним точкам:
\begin{tabbing}
    \hspace*{5cm}\= \hspace*{1.7cm} \= \hspace*{3cm} \= \kill
    \>
    $\begin{smallmatrix}
        \text{Узлы для}\\
        L_{left}\\
    \end{smallmatrix}
    \begin{cases}
        \\\\
    \end{cases}$
    \>
    \begin{tabular}{|c|c|c|}
        \hline
        $i$ & $x_i$ & $y_i$ \\
        \hline
        0 & 0.5 & 2.08049 \\
        \hline
        1 & 1.25 & 1.89477 \\
        \hline
        2 & 2 & 3.54234 \\
        \hline
        3 & 2.75 & 5.14071 \\
        \hline
    \end{tabular}
    \>\raisebox{-0.6\height}{
        $\begin{rcases}
            \\\\\\
        \end{rcases}
        \begin{smallmatrix}
                \text{Узлы для}\\
                L_{right}
        \end{smallmatrix}$\\
    }
\end{tabbing}

Получившиеся <<левый>> и <<правый>> полиномы:
\begin{align}
    L_{left}(x)  &= 1.62959x^2 - 3.09941x + 3.222798\\
    L_{right}(x) &=-0.04373x^2 + 2.33889x - 0.960513
\end{align}

Тогда производные в крайних точках выражаются аналитически:
\begin{align}
    \mathtt{f_1'}(x_0) &= \dfrac{d}{dx} ~ L_{left}(x_0) = 3.25918x_0 - 3.09941 = -1.46982\\
    \mathtt{f_1'}(x_3) &= \dfrac{d}{dx} ~ L_{right}(x_3)= -0.08746x_3 + 2.33889 = 2.098375
\end{align}

Построим таблицу с полученными приближениями первой производной на узлах:
\begin{align}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $i$ & $x_i$ & $f_1'(x_i)$ & $\mathtt{f_1'}(x_i)$ & $|\mathtt{f_1'}(x_i)-f_1'(x_i)|$ \\
        \hline
        0 & 0.5 & -3.35069 & -1.46982 & 1.88088\\
        \hline
        1 &  1.25 & 1.38959 & 0.97457 &0.415020\\
        \hline
        2 &  2 &  2.79055 & 2.16396 &0.626590\\
        \hline
        3 &  2.75 & -1.36506 & 2.09836 &3.46342\\
        \hline
    \end{tabular}\\
    0.42 \le \varepsilon \le 3.46
\end{align}

Ищем $i$-е звено сплайна $S_3(x)$ в виде:

\begin{equation}
    H_3^i(x) = a_0^i + a_1^i(x-x_{i-1}) + a_2^i(x-x_{i-1})^2 + a_3^i(x-x_{i-1})^3
\end{equation}

Из интерполяционных условий следует:
\begin{equation}
    \begin{rcases}
        H_3^i(x_{i-1}) = y_{i-1} \\
        H_3^i(x_i) = y_i
    \end{rcases} \overset{h:=x_i-x_{i-1}}{\implies}
    \begin{cases}
        a_0^i = y_{i-1} \\
        a_0^i + a_1^ih + a_2^ih^2 + a_3^ih^3 = y_i
    \end{cases}
\end{equation}

Далее дифференциируем (20):
\begin{equation}
    (H_3^i)'(x) = a_1^i + 2a_2^i(x-x_{i-1})+3a_3^i(x-x_{i-1})^2
\end{equation}

И из интерполяционных условий получим:
\begin{equation}
    \begin{rcases}
        (H_3^i)'(x_{i-1}) = y'_{i-1} \\
        (H_3^i)'(x_i) = y'_i
    \end{rcases} \implies
    \begin{cases}
        a_1^i = y'_{i-1} \\
        a_1^i + 2a_2^ih_i + 3a_3^ih_i^2 = y'_i
    \end{cases}
\end{equation}

После подстановок получим остальные коэффициенты $a_{j=2,3}^i$:
\begin{equation}
    \begin{matrix}
        a_2^i = \dfrac{1}{h_i^2}(3y_i - 3y_{i-1} - 2h_iy'_{i-1} - h_iy'_i)\\
        a_3^i = \dfrac{1}{h_i^3}(-2y_i + 2y_{i-1} + h_iy'_{i-1} + h_iy'_i)
    \end{matrix}
\end{equation}

Подставляя (21), (23), (24) в (20) для четырёх точек получим 3 звена сплайна (решётка равномерная, так что $h_i=h=const$):
\begin{equation}
    \begin{matrix}
        H_3^1(x) = y_0 + y'_0(x-x_0) +
        \dfrac{1}{h^2}(3y_1 - 3y_0 - 2hy'_0 - hy'_1)(x-x_0)y^2 +
        \dfrac{1}{h^3}(-2y_1 + 2y_0 + hy'_0 + hy'_1)(x-x_0)^3\\
        H_3^2(x) = y_1 + y'_1(x-x_1) +
        \dfrac{1}{h^2}(3y_2 - 3y_1 - 2hy'_1 - hy'_2)(x-x_1)^2 +
        \dfrac{1}{h^3}(-2y_2 + 2y_1 + hy'_1 + hy'_2)(x-x_1)^3\\
        H_3^3(x) = y_2 + y'_2(x-x_2) +
        \dfrac{1}{h^2}(3y_3 - 3y_2 - 2hy'_2 - hy'_3)(x-x_2)^2 +
        \dfrac{1}{h^3}(-2y_3 + 2y_2 + hy'_2 + hy'_3)(x-x_2)^3
    \end{matrix}
\end{equation}

Наконец, подставляя в (25) значения из таблицы (18) и упрощая ($h = 0.75$), получим звенья эрмитова сплайна как многочлены не выше степени 3:
\begin{align}
    H_3^1(x) &= 1.6296x^2 - 3.0994x + 3.2228\\
    H_3^2(x) &= -2.2311x^3 + 11.6695x^2 - 17.7409x + 10.1950\\
    H_3^3(x) &= -0.0437x^2 + 2.3389x - 0.9605
\end{align}

Каждый из которых является приближением функции $f_1(x)$ между соответствующими точками решётки. Подставляя эти значения, протабулируем $4\cdot100$ точек сплайна:
\begin{align}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $k$ & $x_k$ & $f_1(x_k)$ & $H(x_k)$ & $|H(x_k)-f_1(x_k)|$ \\
        \hline
        1 & 0.5      & 2.08049 & 2.08049 & 0 \\
        \hline
        2 & 0.505639 & 2.061887& 2.07904 &  0.01716 \\
        \hline
        3 & 0.511278 & 2.04382 & 2.07749 &  0.03368 \\
        \hline
        $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ &  $\vdots$ \\
        \hline
        399 & 2.74436   & 5.14792 &	5.12888 &  0.01904 \\
        \hline
        400 & 2.75 & 5.14071  & 5.14071 &  0\\
        \hline
    \end{tabular}\\
    \varepsilon \le 0.2986
\end{align}

\subsection{Графики}

\subsubsection{Трансцендентная $f_1(x):$}
\input{pic9-12}

\subsubsection{Полином 5-й степени $f_2(x):$}
\input{pic13-16}

\subsubsection*{Комментарий}
Максимальная ошибка интерполяции сплайном на отрезке монотонно уменьшается при увеличении количества узлов, но не так быстро. В то же время, ошибка интерполяции полиномом Лагранжа сначала снижается (при интерполяции полинома -- даже до уровня машинной точности), однако затем начинает возрастать из-за феномена Рунге. Можно сделать вывод о предпочтительном методе интерполяции для функций различного вида с различным количеством известных узлов и значений производных в них.

\clearpage
\section{Исследование сходимости полинома Лагранжа на равномерной и чебышёвской решётках}

Как было неоднократно замечено, увеличение точности интерполяционного полинома Лагранжа (особенно не полиномиальных функций) за счёт увеличения количества узлов равномерной решётки лимитируется усилением феномена Рунге. Для борьбы с этой проблемой можно использовать не равномерные решётки. Показано, что для этой цели подходит использование многочлена Чебышёва.

\subsection{Формулы}

Многочлен Чебышёва это функция:
\begin{equation}
    T_n(x) := \cos(n\arccos x),~~~ \text{где}~~ n\in \mathbb{N}_0, ~ x \in [-1, 1];
\end{equation}

На отрезке $[-1, 1]$ он имеет ровно $n$ различных вещественных корней, которые задаются формулой:
\begin{equation}
    x_k = \cos\left(\frac{2k+1}{2n}\pi\right), ~~~ k=0,1,...,n-1
\end{equation}

Для задания чебышёвкой решётки на произвольном интервале $[a, b]$ произведём замену:
\begin{equation}
    x_i = \frac{a+b}{2} + \frac{b-a}{2}t_i, ~~~ t_i \in [-1,1]
\end{equation}

Показано, что максимальная погрешность интерполирования достаточно гладкой функции на отрезке $[-1, 1]$ многочленом $n$-й степени будет минимальной, когда в качестве узлов интерполяции $t_0,t_1,...,t_n \in [-1, 1]$ берутся корни многочлена Чебышева $T_{n+1}(t)$

\clearpage
\subsection{Графики}
\subsubsection{Трансцендентная $f_1(x):$}
\input{pic18-21}

\subsubsection{Полином 5-й степени $f_2(x):$}
\input{pic22-26}

\subsubsection*{Комментарий}
Вычислительный эксперимент показал, что решётка Чебышёва эффективно решает проблему появления феномена Рунге при глобальной полиномиальной интерполяции как для полиномиальной, так и для трансцендентной функции. Машинная точность была достигнута при, соответственно, $n_\text{узлов} > \text{\normalsize старшая степень полинома} $ и $n_\text{узлов} > 40$.

\section{Исследование сходимости полинома Лагранжа и сплайна Эрмита при возмущении входных данных}
При работе с экспериментальными данными возникает проблема наличия неустанимых случайных возмущений.

\subsection{Формализация проблемы}

Формализуем понятие "возмущение". Допустим, что при измерении некоторой зависимости присутствовала случайная погрешность. Величина такой погрешности $\Delta_{y_i}$ -- случайная величина. Пусть она подчиняется нормальному распределению:
\begin{align}
    \rho(y) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left[-\frac{1}{2}\left(\frac{y-\mu}{\sigma}\right)^2\right].
\end{align}

Медиана отклонения -- само значение функции $\mu=0$, стандартное отклонение $\sigma$ примем пропорциональным амплитуде значений исследуемой функции $f$ на выбранном участке непрерывности $[a,b]$:
\begin{align}
    \sigma = \mathbf{K} \frac{\sup f(x) - \inf f(x)}{2},
    \hspace{1cm} x\in[a,b]
\end{align}

Так, для $f_1$, интерполированной по четырём узлам $(6)$:
\begin{align}
    \sigma_{f_1} = \mathbf{K} \frac{5.1407 - 1.8948}{2} = 1.623\mathbf{K}
\end{align}

В то же время, для $f_2$, интерполированной по четырём узлам:
\begin{align}
    \sigma_{f_2} = \mathbf{K} \frac{11.5673 - (-2.41344)}{2} = 6.99037\mathbf{K}
\end{align}

Видим, что для разных функций, константа перед $\mathbf{K}$ оказывается разной, т.к. на исследуемых отрезках у этих функций различаются амплитуды и нужно нормировать величину возмущения. Таким образом остаётся менять коэффициент $\mathbf{K}$

\subsection{Графики при фиксированном $\mathbf{K}=0.2$}
\subsubsection{Трансцендентная $f_1(x):$}
\input{pic27-30}

\subsubsection{Полином 5-й степени $f_2(x):$}
\input{pic31-34}

\subsubsection{Графики сходимости при возмущении входных данных}
\begin{figure}[H]
    \centering
    \caption{Зависимость максимальной ошибки интерполяции обеих функций различными методами при фиксированном значении $\mathbf{K}=0.2$ от количества точек интерполяции (без усреднения)}
    \includegraphics[width=1\linewidth]{pics/pic35}
    \label{pic:35}
\end{figure}

\subsubsection*{Комментарий}
С ростом числа узлов у глобальной интерполяции полиномом Лагранжа вследствие феномена Рунге очень быстро нарастает ошибка. Ошибка же эрмитова сплайна остаётся ограниченной некоторой величиной, очевидно зависящей от параметра $\sigma$ (35). Отметим, что техники интерполяции в целом плохо работают на данных с возмущениями. Сплайн можно  безболезненно заменить линейной интерполяцией с сохранением той же максимальной ошибки. Глобальный же полином в принципе ни на что не годится в этом случае.

\begin{figure}[H]
    \centering
    \caption{Зависимость {\it средней} ошибки интерполяции обеих функций различными методами при фиксированном количестве узлов интерполяции $N=20$ от параметра $\mathbf{K}=0.2$ (усреднение по 100)}
    \includegraphics[width=1\linewidth]{pics/pic36}
    \label{pic:36}
\end{figure}

\subsubsection*{Комментарий}
\begin{itemize}
    \item Картины зависимостей для обеих функций аналогичны, отличия лишь в константах: полиномиальная функция $f_2$ (красная палитра) при прочих равных даёт, в среднем, б\'{о}льшую абсолютную ошибку, чем трансцендентная функция $f_1$ (синяя палитра);
    \item Если величина возмущений в узлах распределена нормально, то средняя абсолютная ошибка интерполяции полиномом Лагранжа ($L_U, L_T$) линейно зависит от $\mathbf{K}$;
    \item Использование решётки Чебышёва ($L_T$) снижает ошибку интерполяции Лагранжа на $\sim2$ порядка по сравнению с равномерной решёткой;
    \item При  достаточно больших возмущениях $\mathbf{K}>0.1$ разница в ошибке между решёткой Чебышёва и сплайном на равномерной решётке ничтожна, однако при уменьшении $\mathbf{K}$ ошибка полинома Лагранжа на решётке Чебышёва продолжает падать, в то время как ошибка сплайна остаётся постоянной вплоть до того, что при крайне малых возмущениях $\mathbf{K}< 10^{-5}$ ошибка сплайна превосходит даже ошибку полинома Лагранжа на равномерной решётке (20 узлов).
\end{itemize}
\clearpage

\section{Модульная структура программы}
Реализация всей программы по расчёту всех заданий лабораторной работы достаточно объёмная, приведу содержимое файла, содержащего точку входа:
\begin{lstlisting}[language=c++]
#include "functions.hpp"
#include <thread>
const Vec LIMS_1 = {0.5, 2.75};
const Vec LIMS_2 = {-2.4, 2.1};
int main(int argc, char *argv[]){
    int minNodes = stoi(argv[1]), maxNodes = stoi(argv[2]);
    int interpolCoeff = stoi(argv[3]);
    double distortionModulo = fabs(stod(argv[4]));
    assert(minNodes <= maxNodes && "Lower bound first!\n");
    thread t1, t2;
    for (int i=3; i<=6; i++){
        t1 = thread(do_task, i, f1, minNodes, maxNodes, interpolCoeff, distortionModulo);
        t2 = thread(do_task, i, f2, minNodes, maxNodes, interpolCoeff, distortionModulo);
        t1.join(); t2.join();
        cout <<  "Task " << i << " done!\n";
    }
    return 0;
}
\end{lstlisting}
Как видно, она использует два потока для параллельного расчёта двух функций. Вдаваться в детали реализации каждой вспомогательной функции считаем непродуктивным, так что приведу лишь сущностную часть заголовочного файла $\mathtt{functions.hpp}$:
\begin{lstlisting}[language=c++]
using namespace std;
using Vec = vector<double>;
struct Graphic {
    Vec xVals;
    Vec yVals;
    double dx;
    int N; };
double f1(double x, bool derivative=false);
double f2(double x, bool derivative=false);
double sum(const Vec& v);    double mean(const Vec& v);    double amplitude(Vec vector);
pair<double, double> lagrange_uniform_single_value_with_error(
    double (*f)(double, bool),
    const double x,
    const Vec& lims,
    const int nNodes
);
Vec chebyshevGrid(double a, double b, int n);
Vec uniformGrid(double a, double b, int n);
Vec errorProfile(const Vec& v1, const Vec& v2);
Graphic tabulateFunction(double (*f)(double, bool), const Vec& grid);
Graphic tabulateDerivative(double (*f)(double, bool), const Graphic& nodes);
Graphic tabulateDerivativeNum(const Graphic& main, int LagrangePoints=3);
Graphic lagrangeInterpol(const Graphic& nodes, const Vec& grid);
Graphic hermiteSpline(const Graphic& function, const Graphic& derivative, int N);
Graphic deviate(const Graphic& g, double sigma);
\end{lstlisting}
Основной структурой, содержащей результаты вычислений является $\mathtt{Graphic}$. Он содержит поля для векторов с координатами по осям, количество узлов и среднее расстояние между узлами (не использовалось при расчёте решёток Чебышёва.) Все расчётные процедуры в той или иной форме работают именно с этой структурой, поэтому позже была добавлена процедура $\mathtt{lagrange\_uniform\_single\_value\_with\_error}$ для вычисления величины ошибки единственной произвольной точки, которая возвращает пару значение-абсолютная ошибка интерполяции функции.


\end{document}