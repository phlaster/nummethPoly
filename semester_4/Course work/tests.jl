using LinearAlgebra, Statistics

L = rand(-10:10, 5,5) |> LowerTriangular |> Matrix
U = rand(-10:10, 5,5) |> UpperTriangular |> Matrix
x = rand(1:9, 5)
bL = L*x
bU = U*x
L\b

w0 = [4,5,1,6];
w = w0 ./ norm(w0);
H = I - 2w*w';
D = diagm([5,3,2,1]);
A = H'*D*H;

A[1,4] = A[4,1] = 0

C = cholesky(Hermitian(A))
C.L' * C.U'

function chol(A)
    n = size(A, 1)  # Получаем размер матрицы A
    L = zeros(n, n)  # Создаем нулевую матрицу L того же размера
    
    for j in 1:n
        print("j = $j")
        @show _su = j == 0 ? [0] : [L[j, k]^2 for k in 1:j-1]
        @show su = sum(_su)
        @show s = A[j, j] - su
        @show L[j, j] = sqrt(s)
        println("DIAG:")
        display(round.([A L], digits=2))
        for i in j+1:n
            print("i = $i")
            @show _su = j == 0 ? [0] : [L[i, k]*L[j, k] for k in 1:j-1]
            @show su = sum( _su )
            @show s = A[i, j] - su
            @show L[i, j] = s / L[j, j]
        end
        println("REST:")
        display(round.([A L], digits=2))
    end
    return L
end

A = rand(0:1, 5,5); A = A*A' + diagm(2 .*ones(Int, 5))
A .*= A
L = zeros(5,5)

C = chol(A)

round.([A L], digits = 1)

j += 1
L[j, j] = sqrt(A[j, j] - sum( [L[j, k]^2 for k in 1:j-1] ))

for i in j+1:5
    L[i, j] = (A[i, j] - sum( [L[i, k]*L[j, k] for k in 1:j-1] )) / L[j, j]
end




using CairoMakie, CSV, ColorSchemes, DataFrames


function plot_baza_1()
    tickformat(values) = [L"10^{%$(round(Int, log10(value)))}" for value in values]


    f1 = CSV.read("CSVs/model_task.csv", DataFrame)
    f2 = CSV.read("CSVs/rand_task.csv", DataFrame)
    kwargs = (;
    xminorticksvisible = true,
    xminorgridvisible = true,
    yminorticksvisible = true,
    yminorgridvisible = true,)
    
    f = Figure(resolution = (1200, 800))
    ax1 = CairoMakie.Axis(f[1, 1];
        backgroundcolor = :gray90,
        xlabel = "порог", ylabel = "шаги",
        xticks = 10. .^ [-10:4;],
        yticks = [0:10:70;],
        xtickformat = tickformat,
        xminorticks = IntervalsBetween(10),
        yminorticks = IntervalsBetween(10),
        xscale=log10,
        kwargs...
	)
    ylims!(-15, 70)
    scatterlines!(
        f2[!, 1], f2[!, 2],
        color = :grey40,
        label = "предобусловленная случайная система"
    )
    scatterlines!(
        f2[!, 1], fill(63, 55),
        color = :orange2,
        label = "случайная система без предобуславливателя"
    )

    scatterlines!(
        f1[!, 1], f1[!, 2],
        color = :royalblue,
        label = "предобусловленная стац. задача"
    )
    scatterlines!(
        f1[!, 1], fill(32, 55),
        color = :crimson,
        label = "стац. задача без предобуславливателя"
    )
    axislegend(position=:lb)
    f
end
plot_baza_1()



x_ex = [
    -0.100649, -0.0990974, -0.0965287, -0.0929694, -0.0884562, -0.0830353, -0.0767623, -0.0697016, -0.0619257, -0.0535144, -0.0445539, -0.0351363, -0.0253581, -0.0153197, -0.00512409, 0.00512409, 0.0153197, 0.0253581, 0.0351363, 0.0445539, 0.0535144, 0.0619257, 0.0697016, 0.0767623, 0.0830353, 0.0884562, 0.0929694, 0.0965287, 0.0990974, 0.100649, -0.200266, -0.197178, -0.192067, -0.184985, -0.176005, -0.165218, -0.152737, -0.138688, -0.123216, -0.10648, -0.0886507, -0.069912, -0.050456, -0.0304822, -0.0101956, 0.0101956, 0.0304822, 0.050456, 0.069912, 0.0886507, 0.10648, 0.123216, 0.138688, 0.152737, 0.165218, 0.176005, 0.184985, 0.192067, 0.197178, 0.200266, -0.297827, -0.293235, -0.285634, -0.275102, -0.261747, -0.245706, -0.227144, -0.206251, -0.183242, -0.158352, -0.131838, -0.10397, -0.0750361, -0.0453319, -0.0151625, 0.0151625, 0.0453319, 0.0750361, 0.10397, 0.131838, 0.158352, 0.183242, 0.206251, 0.227144, 0.245706, 0.261747, 0.275102, 0.285634, 0.293235, 0.297827, -0.392333, -0.386283, -0.37627, -0.362396, -0.344804, -0.323673, -0.299221, -0.271698, -0.241388, -0.2086, -0.173672, -0.136962, -0.0988463, -0.0597164, -0.0199738, 0.0199738, 0.0597164, 0.0988463, 0.136962, 0.173672, 0.2086, 0.241388, 0.271698, 0.299221, 0.323673, 0.344804, 0.362396, 0.37627, 0.386283, 0.392333, -0.482812, -0.475368, -0.463046, -0.445972, -0.424322, -0.398318, -0.368227, -0.334357, -0.297056, -0.256707, -0.213724, -0.168548, -0.121642, -0.0734882, -0.0245801, 0.0245801, 0.0734882, 0.121642, 0.168548, 0.213724, 0.256707, 0.297056, 0.334357, 0.368227, 0.398318, 0.424322, 0.445972, 0.463046, 0.475368, 0.482812, -0.568337, -0.559574, -0.545069, -0.524971, -0.499486, -0.468876, -0.433454, -0.393585, -0.349677, -0.30218, -0.251583, -0.198404, -0.14319, -0.0865059, -0.0289343, 0.0289343, 0.0865059, 0.14319, 0.198404, 0.251583, 0.30218, 0.349677, 0.393585, 0.433454, 0.468876, 0.499486, 0.524971, 0.545069, 0.559574, 0.568337, -0.648031, -0.638039, -0.6215, -0.598584, -0.569525, -0.534623, -0.494234, -0.448774, -0.398709, -0.344553, -0.286861, -0.226225, -0.163268, -0.0986359, -0.0329915, 0.0329915, 0.0986359, 0.163268, 0.226225, 0.286861, 0.344553, 0.398709, 0.448774, 0.494234, 0.534623, 0.569525, 0.598584, 0.6215, 0.638039, 0.648031, -0.721074, -0.709956, -0.691553, -0.666054, -0.63372, -0.594883, -0.549942, -0.499358, -0.44365, -0.383389, -0.319195, -0.251724, -0.181671, -0.109754, -0.0367102, 0.0367102, 0.109754, 0.181671, 0.251724, 0.319195, 0.383389, 0.44365, 0.499358, 0.549942, 0.594883, 0.63372, 0.666054, 0.691553, 0.709956, 0.721074, -0.786719, -0.774589, -0.75451, -0.72669, -0.691412, -0.64904, -0.600008, -0.544818, -0.484039, -0.418292, -0.348253, -0.274641, -0.19821, -0.119745, -0.0400521, 0.0400521, 0.119745, 0.19821, 0.274641, 0.348253, 0.418292, 0.484039, 0.544818, 0.600008, 0.64904, 0.691412, 0.72669, 0.75451, 0.774589, 0.786719, -0.84429, -0.831272, -0.809725, -0.779868, -0.742009, -0.696536, -0.643916, -0.584688, -0.51946, -0.448902, -0.373738, -0.294739, -0.212715, -0.128508, -0.0429831, 0.0429831, 0.128508, 0.212715, 0.294739, 0.373738, 0.448902, 0.51946, 0.584688, 0.643916, 0.696536, 0.742009, 0.779868, 0.809725, 0.831272, 0.84429, -0.893198, -0.879426, -0.856631, -0.825044, -0.784992, -0.736885, -0.681216, -0.618558, -0.549552, -0.474906, -0.395388, -0.311812, -0.225037, -0.135953, -0.0454731, 0.0454731, 0.135953, 0.225037, 0.311812, 0.395388, 0.474906, 0.549552, 0.618558, 0.681216, 0.736885, 0.784992, 0.825044, 0.856631, 0.879426, 0.893198, -0.932941, -0.918556, -0.894746, -0.861755, -0.81992, -0.769673, -0.711527, -0.64608, -0.574004, -0.496037, -0.412981, -0.325686, -0.23505, -0.142002, -0.0474964, 0.0474964, 0.142002, 0.23505, 0.325686, 0.412981, 0.496037, 0.574004, 0.64608, 0.711527, 0.769673, 0.81992, 0.861755, 0.894746, 0.918556, 0.932941, -0.96311, -0.948261, -0.92368, -0.889622, -0.846435, -0.794562, -0.734536, -0.666973, -0.592566, -0.512078, -0.426336, -0.336218, -0.242651, -0.146594, -0.0490323, 0.0490323, 0.146594, 0.242651, 0.336218, 0.426336, 0.512078, 0.592566, 0.666973, 0.734536, 0.794562, 0.846435, 0.889622, 0.92368, 0.948261, 0.96311, -0.983397, -0.968234, -0.943136, -0.908361, -0.864264, -0.811299, -0.750008, -0.681022, -0.605047, -0.522864, -0.435316, -0.3433, -0.247762, -0.149682, -0.0500651, 0.0500651, 0.149682, 0.247762, 0.3433, 0.435316, 0.522864, 0.605047, 0.681022, 0.750008, 0.811299, 0.864264, 0.908361, 0.943136, 0.968234, 0.983397, -0.993592, -0.978273, -0.952915, -0.917778, -0.873224, -0.81971, -0.757784, -0.688083, -0.61132, -0.528285, -0.439829, -0.346859, -0.250331, -0.151233, -0.0505842, 0.0505842, 0.151233, 0.250331, 0.346859, 0.439829, 0.528285, 0.61132, 0.688083, 0.757784, 0.81971, 0.873224, 0.917778, 0.952915, 0.978273, 0.993592, -0.993592, -0.978273, -0.952915, -0.917778, -0.873224, -0.81971, -0.757784, -0.688083, -0.61132, -0.528285, -0.439829, -0.346859, -0.250331, -0.151233, -0.0505842, 0.0505842, 0.151233, 0.250331, 0.346859, 0.439829, 0.528285, 0.61132, 0.688083, 0.757784, 0.81971, 0.873224, 0.917778, 0.952915, 0.978273, 0.993592, -0.983397, -0.968234, -0.943136, -0.908361, -0.864264, -0.811299, -0.750008, -0.681022, -0.605047, -0.522864, -0.435316, -0.3433, -0.247762, -0.149682, -0.0500651, 0.0500651, 0.149682, 0.247762, 0.3433, 0.435316, 0.522864, 0.605047, 0.681022, 0.750008, 0.811299, 0.864264, 0.908361, 0.943136, 0.968234, 0.983397, -0.96311, -0.948261, -0.92368, -0.889622, -0.846435, -0.794562, -0.734536, -0.666973, -0.592566, -0.512078, -0.426336, -0.336218, -0.242651, -0.146594, -0.0490323, 0.0490323, 0.146594, 0.242651, 0.336218, 0.426336, 0.512078, 0.592566, 0.666973, 0.734536, 0.794562, 0.846435, 0.889622, 0.92368, 0.948261, 0.96311, -0.932941, -0.918556, -0.894746, -0.861755, -0.81992, -0.769673, -0.711527, -0.64608, -0.574004, -0.496037, -0.412981, -0.325686, -0.23505, -0.142002, -0.0474964, 0.0474964, 0.142002, 0.23505, 0.325686, 0.412981, 0.496037, 0.574004, 0.64608, 0.711527, 0.769673, 0.81992, 0.861755, 0.894746, 0.918556, 0.932941, -0.893198, -0.879426, -0.856631, -0.825044, -0.784992, -0.736885, -0.681216, -0.618558, -0.549552, -0.474906, -0.395388, -0.311812, -0.225037, -0.135953, -0.0454731, 0.0454731, 0.135953, 0.225037, 0.311812, 0.395388, 0.474906, 0.549552, 0.618558, 0.681216, 0.736885, 0.784992, 0.825044, 0.856631, 0.879426, 0.893198, -0.84429, -0.831272, -0.809725, -0.779868, -0.742009, -0.696536, -0.643916, -0.584688, -0.51946, -0.448902, -0.373738, -0.294739, -0.212715, -0.128508, -0.0429831, 0.0429831, 0.128508, 0.212715, 0.294739, 0.373738, 0.448902, 0.51946, 0.584688, 0.643916, 0.696536, 0.742009, 0.779868, 0.809725, 0.831272, 0.84429, -0.786719, -0.774589, -0.75451, -0.72669, -0.691412, -0.64904, -0.600008, -0.544818, -0.484039, -0.418292, -0.348253, -0.274641, -0.19821, -0.119745, -0.0400521, 0.0400521, 0.119745, 0.19821, 0.274641, 0.348253, 0.418292, 0.484039, 0.544818, 0.600008, 0.64904, 0.691412, 0.72669, 0.75451, 0.774589, 0.786719, -0.721074, -0.709956, -0.691553, -0.666054, -0.63372, -0.594883, -0.549942, -0.499358, -0.44365, -0.383389, -0.319195, -0.251724, -0.181671, -0.109754, -0.0367102, 0.0367102, 0.109754, 0.181671, 0.251724, 0.319195, 0.383389, 0.44365, 0.499358, 0.549942, 0.594883, 0.63372, 0.666054, 0.691553, 0.709956, 0.721074, -0.648031, -0.638039, -0.6215, -0.598584, -0.569525, -0.534623, -0.494234, -0.448774, -0.398709, -0.344553, -0.286861, -0.226225, -0.163268, -0.0986359, -0.0329915, 0.0329915, 0.0986359, 0.163268, 0.226225, 0.286861, 0.344553, 0.398709, 0.448774, 0.494234, 0.534623, 0.569525, 0.598584, 0.6215, 0.638039, 0.648031, -0.568337, -0.559574, -0.545069, -0.524971, -0.499486, -0.468876, -0.433454, -0.393585, -0.349677, -0.30218, -0.251583, -0.198404, -0.14319, -0.0865059, -0.0289343, 0.0289343, 0.0865059, 0.14319, 0.198404, 0.251583, 0.30218, 0.349677, 0.393585, 0.433454, 0.468876, 0.499486, 0.524971, 0.545069, 0.559574, 0.568337, -0.482812, -0.475368, -0.463046, -0.445972, -0.424322, -0.398318, -0.368227, -0.334357, -0.297056, -0.256707, -0.213724, -0.168548, -0.121642, -0.0734882, -0.0245801, 0.0245801, 0.0734882, 0.121642, 0.168548, 0.213724, 0.256707, 0.297056, 0.334357, 0.368227, 0.398318, 0.424322, 0.445972, 0.463046, 0.475368, 0.482812, -0.392333, -0.386283, -0.37627, -0.362396, -0.344804, -0.323673, -0.299221, -0.271698, -0.241388, -0.2086, -0.173672, -0.136962, -0.0988463, -0.0597164, -0.0199738, 0.0199738, 0.0597164, 0.0988463, 0.136962, 0.173672, 0.2086, 0.241388, 0.271698, 0.299221, 0.323673, 0.344804, 0.362396, 0.37627, 0.386283, 0.392333, -0.297827, -0.293235, -0.285634, -0.275102, -0.261747, -0.245706, -0.227144, -0.206251, -0.183242, -0.158352, -0.131838, -0.10397, -0.0750361, -0.0453319, -0.0151625, 0.0151625, 0.0453319, 0.0750361, 0.10397, 0.131838, 0.158352, 0.183242, 0.206251, 0.227144, 0.245706, 0.261747, 0.275102, 0.285634, 0.293235, 0.297827, -0.200266, -0.197178, -0.192067, -0.184985, -0.176005, -0.165218, -0.152737, -0.138688, -0.123216, -0.10648, -0.0886507, -0.069912, -0.050456, -0.0304822, -0.0101956, 0.0101956, 0.0304822, 0.050456, 0.069912, 0.0886507, 0.10648, 0.123216, 0.138688, 0.152737, 0.165218, 0.176005, 0.184985, 0.192067, 0.197178, 0.200266, -0.100649, -0.0990974, -0.0965287, -0.0929694, -0.0884562, -0.0830353, -0.0767623, -0.0697016, -0.0619257, -0.0535144, -0.0445539, -0.0351363, -0.0253581, -0.0153197, -0.00512409, 0.00512409, 0.0153197, 0.0253581, 0.0351363, 0.0445539, 0.0535144, 0.0619257, 0.0697016, 0.0767623, 0.0830353, 0.0884562, 0.0929694, 0.0965287, 0.0990974, 0.100649
]

x_appr = [
    -0.100658, -0.0991131, -0.0965498, -0.0929945, -0.0884839, -0.0830642, -0.0767914, -0.0697299, -0.0619521, -0.0535381, -0.0445743, -0.0351527, -0.0253702, -0.0153271, -0.00512657, 0.00512657, 0.0153271, 0.0253702, 0.0351527, 0.0445743, 0.0535381, 0.0619521, 0.0697299, 0.0767914, 0.0830642, 0.0884839, 0.0929945, 0.0965498, 0.0991131, 0.100658, -0.200283, -0.197209, -0.192109, -0.185035, -0.17606, -0.165276, -0.152795, -0.138744, -0.123269, -0.106527, -0.0886912, -0.0699448, -0.05048, -0.0304969, -0.0102005, 0.0102005, 0.0304969, 0.05048, 0.0699448, 0.0886912, 0.106527, 0.123269, 0.138744, 0.152795, 0.165276, 0.17606, 0.185035, 0.192109, 0.197209, 0.200283, -0.297853, -0.293282, -0.285697, -0.275176, -0.261829, -0.245792, -0.22723, -0.206335, -0.18332, -0.158423, -0.131898, -0.104019, -0.0750718, -0.0453537, -0.0151698, 0.0151698, 0.0453537, 0.0750718, 0.104019, 0.131898, 0.158423, 0.18332, 0.206335, 0.22723, 0.245792, 0.261829, 0.275176, 0.285697, 0.293282, 0.297853, -0.392366, -0.386345, -0.376353, -0.362494, -0.344912, -0.323786, -0.299334, -0.271808, -0.24149, -0.208693, -0.173751, -0.137026, -0.0988933, -0.0597452, -0.0199835, 0.0199835, 0.0597452, 0.0988933, 0.137026, 0.173751, 0.208693, 0.24149, 0.271808, 0.299334, 0.323786, 0.344912, 0.362494, 0.376353, 0.386345, 0.392366, -0.482854, -0.475443, -0.463147, -0.446092, -0.424455, -0.398457, -0.368367, -0.334492, -0.297183, -0.256821, -0.213822, -0.168627, -0.1217, -0.0735236, -0.024592, 0.024592, 0.0735236, 0.1217, 0.168627, 0.213822, 0.256821, 0.297183, 0.334492, 0.368367, 0.398457, 0.424455, 0.446092, 0.463147, 0.475443, 0.482854, -0.568386, -0.559663, -0.545189, -0.525113, -0.499643, -0.46904, -0.433619, -0.393744, -0.349826, -0.302314, -0.251698, -0.198497, -0.143258, -0.0865475, -0.0289483, 0.0289483, 0.0865475, 0.143258, 0.198497, 0.251698, 0.302314, 0.349826, 0.393744, 0.433619, 0.46904, 0.499643, 0.525113, 0.545189, 0.559663, 0.568386, -0.648086, -0.63814, -0.621636, -0.598745, -0.569704, -0.534809, -0.494422, -0.448956, -0.398879, -0.344705, -0.286992, -0.226331, -0.163346, -0.0986833, -0.0330074, 0.0330074, 0.0986833, 0.163346, 0.226331, 0.286992, 0.344705, 0.398879, 0.448956, 0.494422, 0.534809, 0.569704, 0.598745, 0.621636, 0.63814, 0.648086, -0.721136, -0.710069, -0.691705, -0.666234, -0.633918, -0.595091, -0.550151, -0.49956, -0.443839, -0.383559, -0.31934, -0.251842, -0.181758, -0.109807, -0.0367279, 0.0367279, 0.109807, 0.181758, 0.251842, 0.31934, 0.383559, 0.443839, 0.49956, 0.550151, 0.595091, 0.633918, 0.666234, 0.691705, 0.710069, 0.721136, -0.786786, -0.774711, -0.754675, -0.726886, -0.691628, -0.649266, -0.600235, -0.545039, -0.484245, -0.418477, -0.348412, -0.274769, -0.198304, -0.119803, -0.0400715, 0.0400715, 0.119803, 0.198304, 0.274769, 0.348412, 0.418477, 0.484245, 0.545039, 0.600235, 0.649266, 0.691628, 0.726886, 0.754675, 0.774711, 0.786786, -0.844363, -0.831404, -0.809902, -0.780079, -0.742241, -0.696779, -0.64416, -0.584925, -0.519682, -0.449101, -0.373909, -0.294877, -0.212816, -0.12857, -0.0430039, 0.0430039, 0.12857, 0.212816, 0.294877, 0.373909, 0.449101, 0.519682, 0.584925, 0.64416, 0.696779, 0.742241, 0.780079, 0.809902, 0.831404, 0.844363, -0.893275, -0.879566, -0.856818, -0.825267, -0.785238, -0.737142, -0.681475, -0.618808, -0.549786, -0.475117, -0.395569, -0.311958, -0.225144, -0.136018, -0.045495, 0.045495, 0.136018, 0.225144, 0.311958, 0.395569, 0.475117, 0.549786, 0.618808, 0.681475, 0.737142, 0.785238, 0.825267, 0.856818, 0.879566, 0.893275, -0.933021, -0.918702, -0.894942, -0.861987, -0.820177, -0.769941, -0.711797, -0.646342, -0.574248, -0.496257, -0.413169, -0.325839, -0.235162, -0.14207, -0.0475193, 0.0475193, 0.14207, 0.235162, 0.325839, 0.413169, 0.496257, 0.574248, 0.646342, 0.711797, 0.769941, 0.820177, 0.861987, 0.894942, 0.918702, 0.933021, -0.963193, -0.948411, -0.923883, -0.889862, -0.8467, -0.79484, -0.734815, -0.667243, -0.592818, -0.512305, -0.42653, -0.336376, -0.242766, -0.146664, -0.049056, 0.049056, 0.146664, 0.242766, 0.336376, 0.42653, 0.512305, 0.592818, 0.667243, 0.734815, 0.79484, 0.8467, 0.889862, 0.923883, 0.948411, 0.963193, -0.983482, -0.968388, -0.943343, -0.908606, -0.864534, -0.811582, -0.750293, -0.681298, -0.605305, -0.523096, -0.435515, -0.343461, -0.24788, -0.149754, -0.0500893, 0.0500893, 0.149754, 0.24788, 0.343461, 0.435515, 0.523096, 0.605305, 0.681298, 0.750293, 0.811582, 0.864534, 0.908606, 0.943343, 0.968388, 0.983482, -0.993678, -0.978428, -0.953123, -0.918026, -0.873498, -0.819996, -0.758072, -0.688361, -0.611581, -0.528519, -0.44003, -0.347022, -0.25045, -0.151306, -0.0506086, 0.0506086, 0.151306, 0.25045, 0.347022, 0.44003, 0.528519, 0.611581, 0.688361, 0.758072, 0.819996, 0.873498, 0.918026, 0.953123, 0.978428, 0.993678, -0.993678, -0.978428, -0.953123, -0.918026, -0.873498, -0.819996, -0.758072, -0.688361, -0.611581, -0.528519, -0.44003, -0.347022, -0.25045, -0.151306, -0.0506086, 0.0506086, 0.151306, 0.25045, 0.347022, 0.44003, 0.528519, 0.611581, 0.688361, 0.758072, 0.819996, 0.873498, 0.918026, 0.953123, 0.978428, 0.993678, -0.983482, -0.968388, -0.943343, -0.908606, -0.864534, -0.811582, -0.750293, -0.681298, -0.605305, -0.523096, -0.435515, -0.343461, -0.24788, -0.149754, -0.0500893, 0.0500893, 0.149754, 0.24788, 0.343461, 0.435515, 0.523096, 0.605305, 0.681298, 0.750293, 0.811582, 0.864534, 0.908606, 0.943343, 0.968388, 0.983482, -0.963193, -0.948411, -0.923883, -0.889862, -0.8467, -0.79484, -0.734815, -0.667243, -0.592818, -0.512305, -0.42653, -0.336376, -0.242766, -0.146664, -0.049056, 0.049056, 0.146664, 0.242766, 0.336376, 0.42653, 0.512305, 0.592818, 0.667243, 0.734815, 0.79484, 0.8467, 0.889862, 0.923883, 0.948411, 0.963193, -0.933021, -0.918702, -0.894942, -0.861987, -0.820177, -0.769941, -0.711797, -0.646342, -0.574248, -0.496257, -0.413169, -0.325839, -0.235162, -0.14207, -0.0475193, 0.0475193, 0.14207, 0.235162, 0.325839, 0.413169, 0.496257, 0.574248, 0.646342, 0.711797, 0.769941, 0.820177, 0.861987, 0.894942, 0.918702, 0.933021, -0.893275, -0.879566, -0.856818, -0.825267, -0.785238, -0.737142, -0.681475, -0.618808, -0.549786, -0.475117, -0.395569, -0.311958, -0.225144, -0.136018, -0.045495, 0.045495, 0.136018, 0.225144, 0.311958, 0.395569, 0.475117, 0.549786, 0.618808, 0.681475, 0.737142, 0.785238, 0.825267, 0.856818, 0.879566, 0.893275, -0.844363, -0.831404, -0.809902, -0.780079, -0.742241, -0.696779, -0.64416, -0.584925, -0.519682, -0.449101, -0.373909, -0.294877, -0.212816, -0.12857, -0.0430039, 0.0430039, 0.12857, 0.212816, 0.294877, 0.373909, 0.449101, 0.519682, 0.584925, 0.64416, 0.696779, 0.742241, 0.780079, 0.809902, 0.831404, 0.844363, -0.786786, -0.774711, -0.754675, -0.726886, -0.691628, -0.649266, -0.600235, -0.545039, -0.484245, -0.418477, -0.348412, -0.274769, -0.198304, -0.119803, -0.0400715, 0.0400715, 0.119803, 0.198304, 0.274769, 0.348412, 0.418477, 0.484245, 0.545039, 0.600235, 0.649266, 0.691628, 0.726886, 0.754675, 0.774711, 0.786786, -0.721136, -0.710069, -0.691705, -0.666234, -0.633918, -0.595091, -0.550151, -0.49956, -0.443839, -0.383559, -0.31934, -0.251842, -0.181758, -0.109807, -0.0367279, 0.0367279, 0.109807, 0.181758, 0.251842, 0.31934, 0.383559, 0.443839, 0.49956, 0.550151, 0.595091, 0.633918, 0.666234, 0.691705, 0.710069, 0.721136, -0.648086, -0.63814, -0.621636, -0.598745, -0.569704, -0.534809, -0.494422, -0.448956, -0.398879, -0.344705, -0.286992, -0.226331, -0.163346, -0.0986833, -0.0330074, 0.0330074, 0.0986833, 0.163346, 0.226331, 0.286992, 0.344705, 0.398879, 0.448956, 0.494422, 0.534809, 0.569704, 0.598745, 0.621636, 0.63814, 0.648086, -0.568386, -0.559663, -0.545189, -0.525113, -0.499643, -0.46904, -0.433619, -0.393744, -0.349826, -0.302314, -0.251698, -0.198497, -0.143258, -0.0865475, -0.0289483, 0.0289483, 0.0865475, 0.143258, 0.198497, 0.251698, 0.302314, 0.349826, 0.393744, 0.433619, 0.46904, 0.499643, 0.525113, 0.545189, 0.559663, 0.568386, -0.482854, -0.475443, -0.463147, -0.446092, -0.424455, -0.398457, -0.368367, -0.334492, -0.297183, -0.256821, -0.213822, -0.168627, -0.1217, -0.0735236, -0.024592, 0.024592, 0.0735236, 0.1217, 0.168627, 0.213822, 0.256821, 0.297183, 0.334492, 0.368367, 0.398457, 0.424455, 0.446092, 0.463147, 0.475443, 0.482854, -0.392366, -0.386345, -0.376353, -0.362494, -0.344912, -0.323786, -0.299334, -0.271808, -0.24149, -0.208693, -0.173751, -0.137026, -0.0988933, -0.0597452, -0.0199835, 0.0199835, 0.0597452, 0.0988933, 0.137026, 0.173751, 0.208693, 0.24149, 0.271808, 0.299334, 0.323786, 0.344912, 0.362494, 0.376353, 0.386345, 0.392366, -0.297853, -0.293282, -0.285697, -0.275176, -0.261829, -0.245792, -0.22723, -0.206335, -0.18332, -0.158423, -0.131898, -0.104019, -0.0750718, -0.0453537, -0.0151698, 0.0151698, 0.0453537, 0.0750718, 0.104019, 0.131898, 0.158423, 0.18332, 0.206335, 0.22723, 0.245792, 0.261829, 0.275176, 0.285697, 0.293282, 0.297853, -0.200283, -0.197209, -0.192109, -0.185035, -0.17606, -0.165276, -0.152795, -0.138744, -0.123269, -0.106527, -0.0886912, -0.0699448, -0.05048, -0.0304969, -0.0102005, 0.0102005, 0.0304969, 0.05048, 0.0699448, 0.0886912, 0.106527, 0.123269, 0.138744, 0.152795, 0.165276, 0.17606, 0.185035, 0.192109, 0.197209, 0.200283, -0.100658, -0.0991131, -0.0965498, -0.0929945, -0.0884839, -0.0830642, -0.0767914, -0.0697299, -0.0619521, -0.0535381, -0.0445743, -0.0351527, -0.0253702, -0.0153271, -0.00512657, 0.00512657, 0.0153271, 0.0253702, 0.0351527, 0.0445743, 0.0535381, 0.0619521, 0.0697299, 0.0767914, 0.0830642, 0.0884839, 0.0929945, 0.0965498, 0.0991131, 0.100658
]

xs = LinRange(1/32, 1-1/32, 30)
ys = LinRange(1/32, 1-1/32, 30)
z1 = reshape(x_ex, (30,30))'
z2 = reshape(x_appr, (30,30))'
zs = [cos(x) * sin(y) for x in xs, y in ys]

wireframe(xs, ys, z2, axis=(type=Axis3,), color=:black, linewidth=0.5)
wireframe(xs, ys, z2.-z1, axis=(type=Axis3,), color=:black, linewidth=0.5)

z1 .- z2 |> extrema .|> abs |> maximum