clc;
% –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2. (—á–∞—Å—Ç—å 3)
% –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–∏—Å–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
% –ó–∞–¥–∞—á–∞. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞
% –º–∞—Ç—Ä–∏—Ü–µ
% –ë–ê–ó–ê (0)
%1. –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É 3—Ö3. –í –∫–∞—á–µ—Å—Ç–≤–µ Œµ –≤–∑—è—Ç—å 10-3
N = 3;
eps = 1e-3;
A = zeros(N);

for i=1:N-1
    A(i, i+1) = 1.0;
end
A(N, 1) = eps;

% 2. –° –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ eig –≤—ã—á–∏—Å–ª–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞
eig(A);

%3. –í—ã—á–∏—Å–ª–∏—Ç—å —Ç–æ—á–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ ùúÜ = 3‚àöùúÄ. –£—á–µ—Å—Ç—å,
% —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äì –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —á–∏—Å–ª–æ —Å –º–æ–¥—É–ª–µ–º 0.1
r = nthroot(eps, N);
eigens = [];
for i=1:N
    [x,y] = pol2cart(i*2*pi/N,r);
    eigens = [eigens; x+1i*y];
end
eigens;

% 4. –í—ã—á–∏—Å–ª–∏—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
errors(1:N) = abs(eigens - eig(A));

% –ú–ò–ù–ò–ú–£–ú (+1)
% 5. –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ 4—Ö4, 10—Ö10,100—Ö100. –ó–∞ Œµ –±—Ä–∞—Ç—å 10-n,
% –≥–¥–µ n ‚Äì —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã. –ü—Ä–æ—Å–ª–µ–¥–∏—Ç—å –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –æ—à–∏–±–∫–∏ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏
% —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
% –î–û–°–¢–ê–¢–û–ß–ù–û (+1)
% 6. –í —Ü–∏–∫–ª–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É –º–∞—Ç—Ä–∏—Ü—ã –æ—Ç 3 –¥–æ 100 —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫
% 7. –í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Ç—Ä–∏—Ü—ã
clear;
err_progression = [];
for size = 3:100
    eps = 10^-size;
    A = zeros(size);
    for i=1:size-1
        A(i, i+1) = 1.0;
    end
    A(size, 1) = eps;
    r = nthroot(eps, size);
    eigens = [];
    for i=1:size
        [x,y] = pol2cart(i*2*pi/size,r);
        eigens = [eigens; x+1i*y];
    end
    % –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    errors(1:size) = abs(cplxpair(eigens) - cplxpair(eig(A)));
    err_progression = [err_progression max(errors)];
end
err_progression;

semilogy(3:100, err_progression)
grid on
hold on
xlabel('–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã')
ylabel('–û—à–∏–±–∫–∞')
title("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ")


%%%%%%%%%
%%%%%%%%%
% Q-R –∞–ª–≥–æ—Ä–∏—Ç–º
size = 5
eps = 10^-size;
A = zeros(size);
for i=1:size-1
    A(i, i+1) = 1.0;
end
A(size, 1) = eps;
A

for i=1:5 % –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π –∫ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –º–∞—Ç—Ä–∏—Ü–µ
    [Q, R] = qr(A);
    A = R * Q   % –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ —ç–ø—Å–∏–ª–æ–Ω –±–µ–≥–∞–µ—Ç –ø–æ –Ω–µ–Ω—É–ª–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
end
% –ö–∞–∫ –≤–∏–¥–∏–º, QR –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ç–∞–∫–æ–π –º–∞—Ç—Ä–∏—Ü—ã

